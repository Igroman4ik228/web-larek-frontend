# Проектная работа "Веб-ларек"

**Стек**: HTML, SCSS, TS, Webpack

**Структура проекта**:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

**Важные файлы**:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура
Используется парадигма **MVP** (Model-View-Presenter), которая предполагает 3 слоя приложения:
- Модель (Model) - бизнес-логика, хранение и изменение данных
- Представление (View) - отображение данных и передача пользовательского ввода презентеру
- Презентер (Presenter) - посредник между моделью и представлением

Также используется событийно-ориентированный подход к передаче данных между слоями.

## Базовые компоненты

### 1. API (``Api``)
Реализует базовый функционал отправки любых запросов на сервер.

**Поля**:
- ``baseUrl: string`` - базовый URL для отправки запросов
- ``_options: RequestInit`` - опции для отправки запросов

**Методы**:
- ``_handleResponse<T>(response: Response)`` - обрабатывает ответ от сервера
- ``_get<T>(uri: string)`` - получить данные с сервера
- ``_post<T>(uri: string, data: object, method: ApiPostMethods = "POST")`` - отправить данные на сервер

Типы запросов для отправки данных на сервер: ``type ApiPostMethods = "POST" | "PUT" | "DELETE";``

### 2. Брокер событий (``EventEmitter``)
Обеспечивает работу событий. 
Список событий описан в перечислениях ``ViewStates`` ``ModalStates`` ``ModelStates`` в файле src/types/index.ts


### 3. Компонент представления (``Component``)
Абстрактный класс для реализации представления. Содержит полезные, универсальные методы для работы с DOM-элементами.



## Слой модель (бизнес-логика)
В данном слое реализована внутренняя логика приложения. Осуществляется получения, хранение и изменение данных.

### Реализация API (``LarekApi``)
Реализует работу с API Веб Ларька.

Базовые интерфейсы для работы с API описаны в файле src/types/model/larekApi.ts: 

interface IProduct {
    id: string;
    description: string;
    image: string;
    title: string;
    category: string;
    price: number | null;
}


interface IOrder {
    payment: string;
    address: string;
    email: string;
    phone: string;
    total: number;
    items: string[];
}

interface IOrderResult {
    id: string;
    total: number;
}

### Модель каталога (``CatalogModel``)
Реализует логику работы с каталогом товаров.

В конструктор принимает объект брокера событий, так как использует его для вызова события при изменении данных в каталоге.

**Поля**:
- ``_products`` — список товаров

**Методы**:
- *set* products(value: IProduct[]) - установить список товаров (вызывает событие ``ModelStates.catalogChange``)
- *get* products(): IProduct[] - получить список товаров

### Модель корзины (``BasketModel``)
Реализует логику хранения и работу данных корзины. В корзину нельзя добавлять одинаковые товары.

**Поля**:
- ``_productIds: Set<string>`` — список уникальных id товаров в корзине

**Методы**:
- *get* ``productIds(): string[]`` — получить список id товаров в корзине
- *get* ``totalPrice(): number`` — получить общую стоимость товаров в корзине
- ``add(productId: string)``— добавить товар в корзину
- ``remove(productId: string)`` — удалить товар из корзины
- ``has(productId: string)`` — проверить наличие товара в корзине
- ``getIndex(productId: string)`` — получить индекс элемента в корзине
- ``clear()`` — очистить корзину


### Модель данных пользователя



## Слой представление (визуализация)

## Слой презентера (обработка событий)
Код презентера не выделен в отдельный класс и находится в основном скрипте приложения (src/index.ts)

